---
layout: post
title: "Claude Code の使用量をVS Codeのステータスバーでリアルタイム監視する「vscode-claude-status」を作った"
img_path: /assets/img/logos
image:
  path: logo-only.svg
  width: 100%
  height: 100%
  alt: Zenn
category: [Tech]
tags: ["claudecode", "claude", "vscode", "typescript", "個人開発"]
date: "2026-02-28 12:00"
---


---

この記事は[Zenn](https://zenn.dev/long910/articles/2026-02-28-vscode-claude-status)でも公開しています。


Claude Code を使っていると「気づいたら使用量が上限に達していた」という経験、ありませんか？

エディタで作業に集中しているとつい忘れてしまう使用量の確認。かといって別のコマンドやブラウザを開くのも手間です。

そこで、**VS Codeのステータスバーに常時表示**する拡張機能「vscode-claude-status」を作りました。

https://github.com/long-910/vscode-claude-status

https://marketplace.visualstudio.com/items?itemName=long-kudo.vscode-claude-status

---

## こんな画面になります

VS Codeの下部ステータスバーに、こんな表示が常に出ます：

**パーセントモード：**
```
🤖 5h:45% 7d:62%
```

これだけで「5時間ウィンドウの消費率45%、週間消費率62%」がひと目でわかります。

**コストモードに切り替えると：**
```
🤖 5h:$14.21 7d:$53.17
```

現在の5時間ウィンドウと今週でいくら使ったかもリアルタイムで確認できます。

ステータスバーをクリックすると、詳細なダッシュボードも開きます。

---

## なぜ作ったか

Claude Code の使用量制限は「5時間のローリングウィンドウ」と「週間制限」の2つで管理されています（詳細は[こちらの記事](https://zenn.dev/long910/articles/2026-02-21-claude-code-usage-limit)を参照）。

問題は、この使用量が**どこにも常時表示されない**ことです。

- 上限に達してから初めて「あ、使いすぎた」と気づく
- ターミナルでコマンドを打って確認するのが面倒
- VS Code で作業中にエディタを離れたくない

以前に tmux ユーザー向けの [claude-tmux-status](https://zenn.dev/long910/articles/2026-02-23-claude-tmux-status) を作りましたが、「**VS Codeで直接確認したい**」という需要にこたえるのがこの拡張機能です。VS Codeのステータスバーには常に情報が表示されています。**Claude Code の使用量もそこに並べてしまおう**というのが発想の出発点です。

---

## 機能

### ステータスバー表示

#### パーセントモード（デフォルト）

```
🤖 5h:45% 7d:62%
```

| 部分     | 意味                    |
| -------- | ----------------------- |
| `5h:45%` | 5時間ウィンドウの消費率 |
| `7d:62%` | 週間消費率              |

75%を超えると警告マーク`!`が付きます。

#### コストモード

```
🤖 5h:$14.21 7d:$53.17
```

| 部分          | 意味                          |
| ------------- | ----------------------------- |
| `5h:$14.21`   | 現在の5時間ウィンドウのコスト |
| `7d:$53.17`   | 週間トータルコスト            |

コスト計算はローカルの JSONL ファイルから行うため、**このモードではAPIを呼び出しません**。

#### ステータスインジケーター

| マーク   | 状態            |
| -------- | --------------- |
| （なし） | 正常（75%未満） |
| `!`      | 警告（75%以上） |
| `✗`      | 上限到達        |

---

### ダッシュボードパネル

ステータスバーをクリックすると、VS Code内に詳細ダッシュボードが開きます。

ダッシュボードでは以下の情報を確認できます：

- **使用量プログレスバー** — 5時間ウィンドウ・週間それぞれの視覚的な消費状況
- **トークンコスト計算** — 入力・出力・キャッシュ別の詳細コスト内訳
- **プロジェクト別コスト追跡** — どのプロジェクトでどれだけ使ったか
- **予測と予算アラート** — バーンレート（$/時間）から5時間ウィンドウ枯渇までの時間を予測
- **使用履歴ヒートマップ** — 日別の使用パターンを一覧で確認

---

### 予算管理機能

コマンドパレット（`Ctrl+Shift+P`）から「Claude Status: Set Budget」を実行すると、日次のUSD予算上限を設定できます。設定した閾値に達すると通知が届くので、使いすぎを防止できます。

---

## 必要環境

- Visual Studio Code 1.109 以上
- Claude Code CLI（`claude login` で認証済みの状態）

---

## インストール

### 方法1: VS Code マーケットプレイスから（推奨）

VS Code内で `Ctrl+Shift+X`（Macは `Cmd+Shift+X`）を押して拡張機能パネルを開き、「Claude Status」で検索してインストールするだけです。

または、以下のコマンドでも直接インストールできます：

```bash
code --install-extension long-kudo.vscode-claude-status
```

### 方法2: マーケットプレイスのページから

[こちらのページ](https://marketplace.visualstudio.com/items?itemName=long-kudo.vscode-claude-status)から「Install」ボタンをクリック。

---

## 使い方

### 表示モードの切り替え

| 操作                    | 機能                          |
| ----------------------- | ----------------------------- |
| ステータスバーをクリック | ダッシュボードを開く          |
| `Ctrl+Shift+Alt+C`      | パーセント↔コストモードを切替 |

コマンドパレット（`Ctrl+Shift+P`）から「Claude Status」で始まるコマンドを検索しても操作できます。

---

## 仕組みと注意点

### データの取得方法

この拡張機能は2種類のデータを組み合わせて使用量を表示します。

**1. ローカル JSONL（コストデータ）**

`~/.claude/projects/**/*.jsonl`（Claude Code がローカルに記録する使用ログ）を読み取り、トークン数とコストを集計します。**APIの呼び出しは不要**で、オフラインでも動作します。

**2. Anthropic API（レート制限データ）**

5時間ウィンドウの消費率（パーセント表示）は Anthropic API のレスポンスヘッダーから取得します。**最大5分に1回**の頻度でAPIを呼び出します。

:::message
**APIを呼び出すと使用量がわずかにカウントされます**

`max_tokens: 1` の最小限リクエストを送信しますが、このリクエスト自体が使用量としてカウントされます。消費量は極めて微量ですが、上限ギリギリの状態では注意してください。認証には `~/.claude/.credentials.json` に保存された OAuth トークンを使用します。
:::

### コストの計算

コストモードでの計算は、Claude Sonnet 4.x の料金体系をベースにしています：

| トークン種別       | 料金（1Mトークンあたり） |
| ------------------ | ------------------------ |
| 入力トークン       | $3.00                    |
| 出力トークン       | $15.00                   |
| キャッシュ読み取り | $0.30                    |
| キャッシュ書き込み | $3.75                    |

---

## claude-tmux-status との違い

同じ Claude Code の使用量監視ツールとして、tmux ユーザー向けの [claude-tmux-status](https://zenn.dev/long910/articles/2026-02-23-claude-tmux-status) もあります。

| 機能                      | vscode-claude-status                   | claude-tmux-status               |
| ------------------------- | -------------------------------------- | -------------------------------- |
| 表示場所                  | VS Codeステータスバー（常時）          | tmuxステータスバー（常時）       |
| ダッシュボード            | ✅（クリックで詳細表示）               | ❌                               |
| プロジェクト別コスト      | ✅                                     | ❌                               |
| 予算管理・アラート        | ✅                                     | ❌                               |
| 使用履歴ヒートマップ      | ✅                                     | ❌                               |
| アイドル時のAPI呼び出し   | 最大5分に1回                           | なし（スマートキャッシュ）       |
| 必要ツール                | VS Code                                | tmux                             |

**VS Codeメインで作業する方**は vscode-claude-status、**ターミナル・tmuxメインの方**は claude-tmux-status、という使い分けが自然です。VS Codeとtmuxを両方使っているなら、どちらも導入して二重に監視するのもアリです。

---

## こんな方におすすめ

- **VS Codeをメインエディタとして使っている開発者**：常時確認できるので使いすぎ防止に
- **Claude Code をヘビーに使っている方**：上限到達による作業中断を減らせます
- **コストを意識したい方**：コストモードや予算設定で日々の出費を把握
- **ターミナルをあまり使わない方**：VS Code 内で完結するので作業フローが途切れない
- **プロジェクト別にコストを追跡したい方**：ダッシュボードでプロジェクト別の内訳が確認可能

---

## まとめ

Claude Code の使用量をVS Codeのステータスバーに常時表示する **vscode-claude-status** を紹介しました。

- VS Codeマーケットプレイスから1クリックでインストールできる
- ステータスバーのクリックだけで詳細ダッシュボードが開く
- パーセントモードとコストモードをキーボードショートカットで切り替え可能
- プロジェクト別コスト追跡・予算アラート・使用履歴ヒートマップなど豊富な機能

Claude Code を日常的に使っているVS Codeユーザーの方は、ぜひ試してみてください。

スターをもらえると励みになります⭐

https://github.com/long-910/vscode-claude-status

---

## 参考リンク

- [Claude Code の使用量上限とうまく付き合う方法](https://zenn.dev/long910/articles/2026-02-21-claude-code-usage-limit) — 使用量制限の仕組みを詳しく解説
- [claude-tmux-status](https://zenn.dev/long910/articles/2026-02-23-claude-tmux-status) — tmuxユーザー向けの使用量監視ツール
- [VS Code マーケットプレイス](https://marketplace.visualstudio.com/items?itemName=long-kudo.vscode-claude-status) — 拡張機能のダウンロードページ
